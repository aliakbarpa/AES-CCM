# AES-CCM
/*This Code is created by Ali Akbar Pammu
PhD student of Nanyang Technological university
Please acknowledge if you used this code for any means
Email : ali1@e.ntu.edu.sg
=============================================================
*************_______________________________________________*/


#include<iostream>
#include<iomanip>
#include "AES_Core.h"

using namespace std;


int main()
{
	int Tlen, Plen;
	unsigned char *S, *O, *C;

	//Example_1; Tlen = 4 bytes::
	unsigned char InitialVectr[16]= { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
	unsigned char SecretKey[16]   = { 0x40, 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x47, 0x48, 0x49, 0x4a, 0x4b, 0x4c, 0x4d, 0x4e, 0x4f };
  /*unsigned char Nonce[16]       = { 0x4f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04 };
	unsigned char Assoc_Data[16]  = { 0x00, 0x08, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
	unsigned char PlainText_1[16] = { 0x20, 0x21, 0x22, 0x23, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
	unsigned char Ctr_0[16]		  = { 0x07, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
	unsigned char Ctr_1[16]       = { 0x07, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01 };*/


	//Example_2
	unsigned char Nonce[16]		  = { 0x56, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10 };
	unsigned char Assoc_Data1[16] = { 0x00, 0x10, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d };
	unsigned char Assoc_Data2[16] = { 0x0e, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
	unsigned char PlainText_1[16] = { 0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27, 0x28, 0x29, 0x2a, 0x2b, 0x2c, 0x2d, 0x2e, 0x2f };
	unsigned char Ctr_0[16]		  = { 0x06, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
	unsigned char Ctr_1[16]		  = { 0x06, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01 };



	AES_Core Encrypt;

	cout << "Welcome to AES-CCM Demo \n";
	//Generating the Tag message
	cout << "Please specify the length of the tag (Tlen < 15) and Length of the plaintext (Plen) \n\n";
	do
	{
		cout << "The Tlen must be less than 15 (bytes) : ";
		cin >> Tlen;
		cout << "The Plen must be equal or less than 16 (bytes) : ";
		cin >> Plen;

	} while (Tlen >= 14 /*|| Plen > 16 || (Plen + Tlen )> 16*/ );
	
	S = new unsigned char [Tlen];
	O = new unsigned char [Tlen];
	C = new unsigned char [Tlen + Plen];
	
	cout << "\n";


	//Getting the IV and Nonce//
	Encrypt.getIVandNonce(InitialVectr, Nonce);
	Encrypt.getSecretKey(SecretKey);
	Encrypt.genCipher();
	cout << "\n";

	//Get the Assoc Data //
	Encrypt.getAssoData(Assoc_Data1);
	Encrypt.getSecretKey(SecretKey);
	Encrypt.genCipher();
	cout << "\n";


	//Get the Assoc Data //
	Encrypt.getAssoData(Assoc_Data2);
	Encrypt.getSecretKey(SecretKey);
	Encrypt.genCipher();
	cout << "\n";
	//Start the encryption_1
	Encrypt.getTagPlaintetxt(PlainText_1);
	Encrypt.getSecretKey(SecretKey);
	Encrypt.genCipher();
	cout << "\n";
	
	//Generating Tag message
	Encrypt.TagMessage(S, Tlen);
		
	//End the Tag generation//
	//==================================//
	
	

	//Start the encryption process//
	//Ctr_0
	Encrypt.genCipher_2(Ctr_0, S, SecretKey);
	Encrypt.OutMessage(O, Tlen);
	
	for (int i = 0; i < Tlen; i++)
	{
		C[i + Plen] = O[i];
		cout << " ";
	}
	cout << endl;

	//Ctr_1 
	Encrypt.genCipher_2(Ctr_1, PlainText_1, SecretKey);
	Encrypt.OutMessage(O, Plen);
	
	cout << "\n\n";
	
	cout << "The Tag message is: \n";
	for (int i = 0; i < Tlen; i++)
	{
		printf("%02x", S[i]);
		cout << " ";
	}
	cout << endl;
	cout << "\n";
	
	for (int i = 0; i < Plen; i++)
	{
		C[i] = O[i];
		cout << " ";
	}
	cout << endl;

	//Ciphertext
	cout << "The Ciphertext is : \n";
	for (int i = 0; i < (Plen + Tlen); i++)
	{
		printf("%02x", (C[i]));
		cout << " ";
	}
	cout << endl;
	cout << "\n\n";

	system("pause");
	return 0;
}


//unsigned char Nonce[16]		  = { 0x54  ,0xab  ,0x10  ,0x13  ,0xbc  ,0xde  ,0xf0  ,0x23  ,0x12  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00 };
//unsigned char Assoc_Data[16]  = { 0x22  ,0x11  ,0x22  ,0x33  ,0x44  ,0x55  ,0x66  ,0x77  ,0x88  ,0x99  ,0xaa  ,0xbb  ,0xcc  ,0xdd  ,0xee  ,0xff };
//unsigned char SecretKey[16]   = { 0x00  ,0x01  ,0x02  ,0x03  ,0x04  ,0x05  ,0x06  ,0x07  ,0x08  ,0x09  ,0x0a  ,0x0b  ,0x0c  ,0x0d  ,0x0e  ,0x0f };
//unsigned char PlainText_1[16] = { 0x00  ,0x11  ,0x22  ,0x33  ,0x44  ,0x55  ,0x66  ,0x77  ,0x88  ,0x99  ,0xaa  ,0xbb  ,0xcc  ,0xdd  ,0xee  ,0xff };
//unsigned char PlainText_2[16] = { 0x11  ,0x11  ,0x22  ,0x33  ,0x44  ,0x55  ,0x66  ,0x77  ,0x88  ,0x99  ,0xaa  ,0xbb  ,0xcc  ,0xdd  ,0xee  ,0xff };
//unsigned char PlainText_3[16] = { 0x11  ,0x11  ,0x22  ,0x33  ,0x44  ,0x55  ,0x66  ,0x77  ,0x88  ,0x99  ,0xaa  ,0xbb  ,0xcc  ,0xdd  ,0xee  ,0xff };
//unsigned char Ctr_1[16]		  = { 0x12  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x01 };
//unsigned char Ctr_2[16]		  = { 0xaa  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x02 };
//unsigned char Ctr_3[16]		  = { 0xbb  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x00  ,0x03 };
